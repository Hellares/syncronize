# üöÄ CustomButton - Documentaci√≥n Completa

## üìã √çndice
- [Descripci√≥n General](#descripci√≥n-general)
- [Caracter√≠sticas Principales](#caracter√≠sticas-principales)
- [Estados del Bot√≥n](#estados-del-bot√≥n)
- [Propiedades](#propiedades)
- [Instalaci√≥n y Uso B√°sico](#instalaci√≥n-y-uso-b√°sico)
- [Integraci√≥n con BLoC](#integraci√≥n-con-bloc)
- [Ejemplos de Uso](#ejemplos-de-uso)
- [Casos de Uso Comunes](#casos-de-uso-comunes)
- [Optimizaciones de Rendimiento](#optimizaciones-de-rendimiento)
- [Troubleshooting](#troubleshooting)

---

## üéØ Descripci√≥n General

El `CustomButton` es un widget avanzado dise√±ado espec√≠ficamente para trabajar con BLoC (Business Logic Component) y gestionar estados de manera eficiente. Proporciona feedback visual inmediato y previene interacciones no deseadas durante procesos as√≠ncronos.

### ‚ú® Caracter√≠sticas Destacadas
- **Gesti√≥n autom√°tica de estados** (idle, loading, success, error)
- **Animaciones fluidas** con efectos de presi√≥n y flash
- **Optimizado para rendimiento** con sistema de cache
- **Integraci√≥n nativa con BLoC**
- **Feedback h√°ptico** opcional
- **Personalizaci√≥n completa** de colores y estilos

---

## üé® Caracter√≠sticas Principales

### üé≠ Estados Visuales
- **Idle**: Estado normal, completamente interactivo
- **Loading**: Muestra spinner + texto, deshabilitado
- **Success**: Muestra √≠cono de check + texto, deshabilitado
- **Error**: Muestra √≠cono de error + texto, deshabilitado

### üé™ Efectos Visuales
- **Animaci√≥n de escala** al presionar
- **Efecto flash** al hacer clic
- **Sombras din√°micas** basadas en colores
- **Bordes animados** que cambian de grosor
- **Gradientes personalizables**

### ‚ö° Optimizaciones
- **Cache inteligente** de valores calculados
- **Pre-c√°lculo** de colores y estilos
- **Reducci√≥n de rebuilds** innecesarios
- **Gesti√≥n eficiente de memoria**

---

## üìä Estados del Bot√≥n

```dart
enum ButtonState {
  idle,     // Estado normal - completamente interactivo
  loading,  // Cargando - muestra CircularProgressIndicator
  success,  // √âxito - muestra √≠cono de check
  error,    // Error - muestra √≠cono de error
}
```

### üîÑ Flujo de Estados T√≠pico
```
idle ‚Üí loading ‚Üí success ‚Üí idle
idle ‚Üí loading ‚Üí error ‚Üí idle
```

---

## üõ†Ô∏è Propiedades

### üîß Propiedades B√°sicas
```dart
class CustomButton extends StatefulWidget {
  final String text;                    // Texto principal del bot√≥n
  final VoidCallback? onPressed;        // Callback al presionar
  final bool enabled;                   // Habilitar/deshabilitar
  final ButtonState buttonState;        // Estado actual del bot√≥n
}
```

### üé® Propiedades de Estilo
```dart
final Gradient gradient;                 // Gradiente de fondo
final Color? borderColor;               // Color del borde
final double borderWidth;               // Grosor del borde
final double? width;                    // Ancho personalizado
final double? height;                   // Alto personalizado
final double? borderRadius;             // Radio de las esquinas
final EdgeInsetsGeometry? padding;      // Padding interno
final TextStyle? textStyle;             // Estilo del texto (prioridad alta)
```

### üé® Propiedades de Texto Personalizables
```dart
final Color? textColor;                 // Color del texto
final FontWeight? fontWeight;           // Peso de la fuente
final double? fontSize;                 // Tama√±o de la fuente
```

### üé® Propiedades de √çconos Personalizables
```dart
final Color? iconColor;                 // Color de los √≠conos (check y error)
```

### üîÑ Propiedades de Estado
```dart
final String? loadingText;              // Texto durante carga
final String? successText;              // Texto en √©xito
final String? errorText;                // Texto en error
final Color? loadingIndicatorColor;     // Color del spinner
final double? loadingIndicatorSize;     // Tama√±o del spinner
final Duration? stateResetDuration;     // Duraci√≥n para resetear estado
```

### ‚öôÔ∏è Propiedades de Animaci√≥n
```dart
final Duration animationDuration;       // Duraci√≥n de animaciones
final bool showHapticFeedback;         // Feedback h√°ptico
```

---

## üöÄ Instalaci√≥n y Uso B√°sico

### 1. Importar el Widget
```dart
import 'package:tu_app/src/presentation/widgets/custom_button.dart';
```

### 2. Uso B√°sico
```dart
CustomButton(
  text: 'Presionar',
  gradient: AppGradients.fondo,
  onPressed: () {
    print('¬°Bot√≥n presionado!');
  },
)
```

### 3. Con Estado
```dart
CustomButton(
  text: 'Iniciar Sesi√≥n',
  gradient: AppGradients.fondo,
  buttonState: ButtonState.loading,
  loadingText: 'Iniciando...',
  onPressed: () {
    // L√≥gica del bot√≥n
  },
)
```

---

## üîÑ Integraci√≥n con BLoC

### 1. Mapeo de Estados
```dart
ButtonState _mapBlocStateToButtonState(AuthState blocState) {
  switch (blocState) {
    case AuthState.idle:
      return ButtonState.idle;
    case AuthState.loading:
      return ButtonState.loading;
    case AuthState.success:
      return ButtonState.success;
    case AuthState.error:
      return ButtonState.error;
  }
}
```

### 2. Implementaci√≥n con BlocBuilder
```dart
BlocBuilder<AuthBloc, AuthState>(
  builder: (context, state) {
    return CustomButton(
      text: 'Iniciar Sesi√≥n',
      gradient: AppGradients.fondo,
      borderColor: AppColors.blue,
      buttonState: _mapBlocStateToButtonState(state),
      loadingText: 'Iniciando sesi√≥n...',
      successText: '¬°Bienvenido!',
      errorText: 'Error de conexi√≥n',
      onPressed: () {
        context.read<AuthBloc>().add(LoginRequested(
          email: _emailController.text,
          password: _passwordController.text,
        ));
      },
    );
  },
)
```

### 3. BLoC Event Handler
```dart
Future<void> _onLoginRequested(
  LoginRequested event,
  Emitter<AuthState> emit,
) async {
  emit(AuthState.loading); // ‚Üí ButtonState.loading
  
  try {
    final result = await authRepository.login(
      event.email,
      event.password,
    );
    
    emit(AuthState.success); // ‚Üí ButtonState.success
    await Future.delayed(Duration(seconds: 1));
    emit(AuthState.idle); // ‚Üí ButtonState.idle
    
  } catch (e) {
    emit(AuthState.error); // ‚Üí ButtonState.error
    await Future.delayed(Duration(seconds: 2));
    emit(AuthState.idle); // ‚Üí ButtonState.idle
  }
}
```

---

## üìù Ejemplos de Uso

### üéØ Ejemplo 1: Login Simple
```dart
CustomButton(
  text: 'Iniciar Sesi√≥n',
  gradient: AppGradients.fondo,
  borderColor: AppColors.blue,
  buttonState: _loginButtonState,
  loadingText: 'Iniciando sesi√≥n...',
  successText: '¬°Bienvenido!',
  errorText: 'Error de conexi√≥n',
  onPressed: _handleLogin,
)
```

### üéØ Ejemplo 2: Registro con Validaci√≥n
```dart
CustomButton(
  text: 'Crear Cuenta',
  gradient: AppGradients.fondoVertical(),
  borderColor: AppColors.green,
  buttonState: _registerButtonState,
  loadingText: 'Creando cuenta...',
  successText: '¬°Cuenta creada!',
  errorText: 'Error al registrar',
  onPressed: _isFormValid ? _handleRegister : null,
)
```

### üéØ Ejemplo 3: Bot√≥n con Personalizaci√≥n Avanzada
```dart
CustomButton(
  text: 'Enviar Datos',
  gradient: AppGradients.fondoHorizontal(),
  borderColor: AppColors.orange,
  borderWidth: 2.0,
  borderRadius: 12.0,
  width: 200,
  height: 50,
  buttonState: _submitButtonState,
  loadingText: 'Enviando...',
  successText: '¬°Enviado!',
  errorText: 'Error al enviar',
  loadingIndicatorColor: Colors.white,
  loadingIndicatorSize: 20.0,
  showHapticFeedback: true,
  onPressed: _handleSubmit,
)
```

### üéØ Ejemplo 4: Bot√≥n con Texto Personalizado
```dart
CustomButton(
  text: 'Texto Personalizado',
  gradient: AppGradients.fondo,
  borderColor: AppColors.blue,
  textColor: Colors.white,           // Color del texto
  fontWeight: FontWeight.bold,       // Peso de la fuente
  fontSize: 18.0,                   // Tama√±o de la fuente
  onPressed: () => print('Presionado'),
)
```

### üéØ Ejemplo 5: Bot√≥n con Diferentes Estilos de Texto
```dart
// Texto grande y negrita
CustomButton(
  text: 'T√≠tulo Grande',
  gradient: AppGradients.fondo,
  fontSize: 24.0,
  fontWeight: FontWeight.w900,
  textColor: Colors.white,
  onPressed: () {},
)

// Texto peque√±o y ligero
CustomButton(
  text: 'Texto Peque√±o',
  gradient: AppGradients.fondoVertical(),
  fontSize: 12.0,
  fontWeight: FontWeight.w300,
  textColor: Colors.black87,
  onPressed: () {},
)

// Texto con color personalizado
CustomButton(
  text: 'Texto Azul',
  gradient: AppGradients.sinfondo,
  borderColor: AppColors.blue,
  textColor: AppColors.blue,
  fontWeight: FontWeight.w600,
  fontSize: 16.0,
  onPressed: () {},
)
```

### üéØ Ejemplo 4: Bot√≥n Simple (Sin Estados)
```dart
CustomButton(
  text: 'Bot√≥n Simple',
  gradient: AppGradients.sinfondo,
  borderColor: AppColors.red,
  onPressed: () {
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(content: Text('¬°Funcionando!')),
    );
  },
)
```

### üéØ Ejemplo 5: Bot√≥n con Texto Personalizado
```dart
CustomButton(
  text: 'Texto Personalizado',
  gradient: AppGradients.fondo,
  borderColor: AppColors.blue,
  textColor: Colors.white,           // Color del texto
  fontWeight: FontWeight.bold,       // Peso de la fuente
  fontSize: 18.0,                   // Tama√±o de la fuente
  onPressed: () => print('Presionado'),
)
```

### üéØ Ejemplo 6: Bot√≥n con Diferentes Estilos de Texto
```dart
// Texto grande y negrita
CustomButton(
  text: 'T√≠tulo Grande',
  gradient: AppGradients.fondo,
  fontSize: 24.0,
  fontWeight: FontWeight.w900,
  textColor: Colors.white,
  onPressed: () {},
)

// Texto peque√±o y ligero
CustomButton(
  text: 'Texto Peque√±o',
  gradient: AppGradients.fondoVertical(),
  fontSize: 12.0,
  fontWeight: FontWeight.w300,
  textColor: Colors.black87,
  onPressed: () {},
)

// Texto con color personalizado
CustomButton(
  text: 'Texto Azul',
  gradient: AppGradients.sinfondo,
  borderColor: AppColors.blue,
  textColor: AppColors.blue,
  fontWeight: FontWeight.w600,
  fontSize: 16.0,
  onPressed: () {},
)
```

### üéØ Ejemplo 7: Bot√≥n con √çconos Personalizados
```dart
// Bot√≥n con √≠conos verdes
CustomButton(
  text: '√âxito Verde',
  gradient: AppGradients.fondo,
  borderColor: AppColors.green,
  iconColor: Colors.green,           // Color de los √≠conos
  textColor: Colors.white,
  fontWeight: FontWeight.bold,
  fontSize: 16.0,
  buttonState: ButtonState.success,   // Para ver el √≠cono de check
  successText: '¬°Completado!',
  onPressed: () {},
)

// Bot√≥n con √≠conos rojos
CustomButton(
  text: 'Error Rojo',
  gradient: AppGradients.fondo,
  borderColor: AppColors.red,
  iconColor: Colors.red,             // Color de los √≠conos
  textColor: Colors.white,
  fontWeight: FontWeight.bold,
  fontSize: 16.0,
  buttonState: ButtonState.error,     // Para ver el √≠cono de error
  errorText: 'Error',
  onPressed: () {},
)

// Bot√≥n con √≠conos azules
CustomButton(
  text: 'Info Azul',
  gradient: AppGradients.sinfondo,
  borderColor: AppColors.blue,
  iconColor: AppColors.blue,         // Color de los √≠conos
  textColor: AppColors.blue,
  fontWeight: FontWeight.w600,
  fontSize: 14.0,
  buttonState: ButtonState.success,
  successText: 'Informaci√≥n',
  onPressed: () {},
)
```

---

## üéØ Casos de Uso Comunes

### üîê Autenticaci√≥n
```dart
// Login
CustomButton(
  text: 'Iniciar Sesi√≥n',
  buttonState: _authBloc.state.buttonState,
  loadingText: 'Verificando...',
  successText: '¬°Bienvenido!',
  errorText: 'Credenciales inv√°lidas',
  onPressed: () => _authBloc.add(LoginRequested()),
)

// Registro
CustomButton(
  text: 'Crear Cuenta',
  buttonState: _authBloc.state.registerState,
  loadingText: 'Creando cuenta...',
  successText: '¬°Cuenta creada!',
  errorText: 'Error al registrar',
  onPressed: () => _authBloc.add(RegisterRequested()),
)
```

### üíæ Operaciones CRUD
```dart
// Guardar
CustomButton(
  text: 'Guardar',
  buttonState: _formBloc.state.saveState,
  loadingText: 'Guardando...',
  successText: '¬°Guardado!',
  errorText: 'Error al guardar',
  onPressed: () => _formBloc.add(SaveRequested()),
)

// Eliminar
CustomButton(
  text: 'Eliminar',
  gradient: AppGradients.error,
  borderColor: AppColors.red,
  buttonState: _deleteBloc.state.deleteState,
  loadingText: 'Eliminando...',
  successText: '¬°Eliminado!',
  errorText: 'Error al eliminar',
  onPressed: () => _deleteBloc.add(DeleteRequested()),
)
```

### üì§ Env√≠o de Datos
```dart
// Enviar formulario
CustomButton(
  text: 'Enviar',
  buttonState: _formBloc.state.submitState,
  loadingText: 'Enviando...',
  successText: '¬°Enviado!',
  errorText: 'Error al enviar',
  onPressed: _isFormValid ? () => _formBloc.add(SubmitRequested()) : null,
)
```

---

## ‚ö° Optimizaciones de Rendimiento

### üéØ Sistema de Cache
El bot√≥n implementa un sistema de cache inteligente que:
- **Pre-calcula** colores de sombra
- **Cachea** gradientes deshabilitados
- **Almacena** estilos de texto
- **Optimiza** border radius y padding

### üîÑ Reducci√≥n de Rebuilds
- **AnimatedBuilder** optimizado
- **Listenable.merge** para m√∫ltiples animaciones
- **setState** m√≠nimo necesario

### üíæ Gesti√≥n de Memoria
- **Dispose** autom√°tico de controllers
- **Cache** con null safety
- **Prevenci√≥n** de memory leaks

---

## üîß Troubleshooting

### ‚ùå Problema: Bot√≥n no responde
**Soluci√≥n:**
```dart
// Verificar que el estado sea idle
buttonState: ButtonState.idle, // ‚úÖ Correcto
buttonState: ButtonState.loading, // ‚ùå Deshabilitado
```

### ‚ùå Problema: Animaciones lentas
**Soluci√≥n:**
```dart
// Reducir duraci√≥n de animaci√≥n
animationDuration: Duration(milliseconds: 200), // M√°s r√°pido
```

### ‚ùå Problema: Colores no se aplican
**Soluci√≥n:**
```dart
// Asegurar que las propiedades est√©n definidas
borderColor: AppColors.blue, // ‚úÖ Definido
gradient: AppGradients.fondo, // ‚úÖ Definido
```

### ‚ùå Problema: Texto no se muestra
**Soluci√≥n:**
```dart
// Verificar que el texto est√© definido
text: 'Mi Bot√≥n', // ‚úÖ Definido
loadingText: 'Cargando...', // ‚úÖ Opcional
```

---

## üìö Mejores Pr√°cticas

### ‚úÖ DO's
- ‚úÖ Usar `BlocBuilder` para gesti√≥n de estados
- ‚úÖ Proporcionar textos para todos los estados
- ‚úÖ Manejar errores apropiadamente
- ‚úÖ Usar colores consistentes con tu tema
- ‚úÖ Implementar feedback h√°ptico para mejor UX

### ‚ùå DON'Ts
- ‚ùå No usar estados loading sin timeout
- ‚ùå No olvidar resetear estados despu√©s de error
- ‚ùå No usar colores que no contrasten bien
- ‚ùå No hacer el bot√≥n muy peque√±o para touch

---

## üé® Personalizaci√≥n Avanzada

### üé® Gradientes Personalizados
```dart
CustomButton(
  text: 'Bot√≥n Personalizado',
  gradient: LinearGradient(
    colors: [Colors.blue, Colors.purple],
    begin: Alignment.topLeft,
    end: Alignment.bottomRight,
  ),
  // ...
)
```

### üé® Sombras Personalizadas
```dart
// El bot√≥n autom√°ticamente genera sombras basadas en borderColor
CustomButton(
  text: 'Con Sombra',
  borderColor: AppColors.blue, // Genera sombra azul
  // ...
)
```

### üé® Animaciones Personalizadas
```dart
CustomButton(
  text: 'Animaci√≥n R√°pida',
  animationDuration: Duration(milliseconds: 150),
  showHapticFeedback: false,
  // ...
)
```

### üé® Texto Personalizado
```dart
// Personalizaci√≥n b√°sica de texto
CustomButton(
  text: 'Mi Bot√≥n',
  textColor: Colors.white,           // Color del texto
  fontWeight: FontWeight.bold,       // Peso de la fuente
  fontSize: 16.0,                   // Tama√±o de la fuente
  // ...
)

// Prioridad de estilos (textStyle tiene prioridad)
CustomButton(
  text: 'Texto con Prioridad',
  textColor: Colors.red,             // Se ignora si textStyle est√° definido
  fontWeight: FontWeight.w600,       // Se ignora si textStyle est√° definido
  fontSize: 18.0,                   // Se ignora si textStyle est√° definido
  textStyle: TextStyle(              // Este tiene prioridad
    color: Colors.blue,
    fontWeight: FontWeight.w900,
    fontSize: 20.0,
  ),
  // ...
)
```

### üé® √çconos Personalizados
```dart
// Color de √≠conos personalizado
CustomButton(
  text: 'Con √çconos',
  iconColor: Colors.green,           // Color de check y error
  textColor: Colors.white,
  // ...
)

// Combinaci√≥n de texto e √≠conos personalizados
CustomButton(
  text: 'Estilo Completo',
  textColor: Colors.white,           // Color del texto
  iconColor: Colors.orange,          // Color de los √≠conos
  fontWeight: FontWeight.bold,
  fontSize: 18.0,
  // ...
)
```

---

## üì± Compatibilidad

### ‚úÖ Plataformas Soportadas
- ‚úÖ Android
- ‚úÖ iOS
- ‚úÖ Web
- ‚úÖ Desktop (Windows, macOS, Linux)

### ‚úÖ Versiones de Flutter
- ‚úÖ Flutter 3.0+
- ‚úÖ Dart 2.17+

---

## ü§ù Contribuci√≥n

Para contribuir al desarrollo del `CustomButton`:

1. **Fork** el repositorio
2. **Crea** una rama para tu feature
3. **Implementa** tus cambios
4. **Testea** exhaustivamente
5. **Env√≠a** un Pull Request

---

## üìÑ Licencia

Este widget est√° bajo la licencia MIT. Ver `LICENSE` para m√°s detalles.

---

## üìû Soporte

Si tienes preguntas o problemas:

- üìß Email: soporte@tuapp.com
- üêõ Issues: GitHub Issues
- üìñ Documentaci√≥n: Esta gu√≠a
- üí¨ Discord: Canal de la comunidad

---

*¬°Disfruta usando tu CustomButton optimizado para BLoC! üöÄ* 